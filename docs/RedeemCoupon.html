<!--
Copyright (C) 2018  CurbShifter

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.

*/
-->
<!DOCTYPE html>
<html lang="en">
<head>
<title>Burst Coupon</title>
<meta charset="utf-8"/>
</head>
<style>
body {font-family: Arial, Helvetica, sans-serif;
    background-color: #88bb3b; /* For browsers that do not support gradients */
    background-image: linear-gradient(to bottom right, #98ea1a , #88bb3b);
	width: 80%;
	margin-left: auto;
    margin-right: auto;
	margin-top: 8%; 
	margin-bottom: 20%; 
}
* {
box-sizing: border-box;
}

a {
  color: #00579d;
  text-decoration: none;
}

/* Full-width input fields */
input[type=text], input[type=password] {
    width: 100%;
    padding: 15px;
    margin: 5px 0 22px 0;
    display: inline-block;
    border: none;
    background: #f1f1f1;
}

input[type=text]:focus, input[type=password]:focus {
    background-color: #ddd;
    outline: none;
}

select {
    width: 100%;
    padding: 15px;
    margin: 5px 0 22px 0;
}

hr {
	border: 1px solid #f1f1f1;
    margin-bottom: 25px;
}

/* Set a style for all buttons */
button {
    background-color: #00579d;
    color: white;
    padding: 14px 20px;
    margin: 8px 0;
    border: none;
    cursor: pointer;
    width: 100%;
    opacity: 0.9;
}

button:hover {
    opacity:1;
}

/* Add padding to container elements */
.container {
    width: 80%;
	margin-left: auto;
    margin-right: auto;
    padding: 80px;
	background-color: white;
	max-width: 700px;
	min-width: 450px;
}

/* Clear floats */
.clearfix::after {
    content: "";
    clear: both;
    display: table;
}

.error_msg {
    color: #F00;
    line-height: 20px;
    font-size: 1.5em;
}

.copyright {
    color: #ccc;
    line-height: 20px;
    font-size: 0.75em;
}
</style>
<body>
<form id="startform" action="/" style="border:0px solid #ccc" name="startform">
  <div class="container" style="text-align:center">
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   version="1.1"
   id="Calque_1"
   x="0px"
   y="0px"
   width="100%" 
   height="200"
   viewBox="0 0 399.99998 199.99999"
   enable-background="new 0 0 700.465 218.988"
   xml:space="preserve"
   sodipodi:docname="burst-coupon.svg"
   inkscape:version="0.92.1 r15371"
   inkscape:export-filename="E:\C++\BurstCoupon-git\trunk\Source\img\text4498.png"
   inkscape:export-xdpi="144"
   inkscape:export-ydpi="144"><metadata
     id="metadata19"><rdf:RDF><cc:Work
         rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><defs
     id="defs17"><marker
       style="overflow:visible"
       id="Scissors"
       orient="auto"
       refY="0"
       refX="0"><path
         style="marker-start:none"
         id="schere"
         d="M 9.0898857,-3.6061018 C 8.1198849,-4.7769976 6.3697607,-4.7358294 5.0623558,-4.2327734 l -8.2124046,3.0779029 c -2.3882933,-1.3067135 -4.7482873,-0.9325372 -4.7482873,-1.5687873 0,-0.4973164 0.4566662,-0.3883222 0.3883068,-1.6831941 -0.065635,-1.2432767 -1.3635771,-2.1630796 -2.5903987,-2.0816435 -1.227271,-0.00735 -2.499439,0.9331613 -2.510341,2.2300611 -0.09143,1.3063864 1.007209,2.5196896 2.306764,2.6052316 1.5223406,0.2266616 4.218258,-0.6955566 5.482945,1.57086006 -0.9422847,1.73825774 -2.6140244,1.74307674 -4.1255107,1.65607034 -1.2548743,-0.072235 -2.7620933,0.2873979 -3.3606483,1.5208605 -0.578367,1.1820862 -0.0112,2.8646022 1.316749,3.226412 1.3401912,0.4918277 3.1806689,-0.129711 3.4993722,-1.6707242 0.2456585,-1.187823 -0.5953659,-1.7459574 -0.2725074,-2.1771537 0.2436135,-0.32536 1.7907806,-0.1368452 4.5471053,-1.3748244 L 5.6763468,4.2330688 C 6.8000164,4.5467672 8.1730685,4.5362646 9.1684433,3.4313614 l -9.22008423,-3.48508362 z m -18.3078016,-1.900504 c 1.294559,0.7227998 1.1888392,2.6835702 -0.1564272,3.0632889 -1.2165179,0.423661 -2.7710269,-0.7589694 -2.3831779,-2.0774648 0.227148,-1.0818519 1.653387,-1.480632 2.5396051,-0.9858241 z m 0.056264,8.0173649 c 1.3508301,0.4988648 1.1214429,2.7844356 -0.2522207,3.091609 -0.9110594,0.3163391 -2.2135494,-0.1387976 -2.3056964,-1.2121394 -0.177609,-1.305055 1.356085,-2.4841482 2.5579171,-1.8794696 z"
         inkscape:connector-curvature="0" /></marker></defs><sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1525"
     inkscape:window-height="1011"
     id="namedview15"
     showgrid="false"
     inkscape:zoom="1.7451366"
     inkscape:cx="230.73761"
     inkscape:cy="113.96378"
     inkscape:window-x="2117"
     inkscape:window-y="0"
     inkscape:window-maximized="0"
     inkscape:current-layer="g4536" /><g
     id="g12"
     transform="matrix(0.5,0,0,0.5,3.1535158,31.283341)"><path
       d="M 230.555,35.538 C 223.736,27.341 211.214,23.355 192.274,23.355 H 141.409 L 128.791,91.44 78.234,91.416 72.596,117.7 H 15.662 l 85.117,27.188 5.786,-24.639 h 16.886 l -13.938,75.239 h 53.844 c 33.472,0 53.832,-14.405 58.877,-41.662 l 2.517,-13.625 c 3.34,-18.004 -1.253,-29.919 -14.032,-36.256 13.067,-6.203 20.647,-16.896 23.688,-33.253 l 1.107,-5.972 c 2.366,-12.781 0.744,-22.327 -4.959,-29.182 z m -42.667,102.096 -2.7,14.568 c -1.923,10.418 -6.802,14.479 -17.403,14.479 h -15.583 l 8.603,-46.449 h 12.371 c 7.107,0 11.392,1.172 13.484,3.689 2.074,2.496 2.476,6.98 1.228,13.713 z m 9.955,-71.184 -1.725,9.312 c -2.036,10.986 -8.102,15.674 -20.282,15.674 h -9.697 l 7.277,-39.296 h 13.554 c 4.844,0 8.015,0.98 9.693,2.999 1.802,2.167 2.189,5.868 1.18,11.311 z"
       id="path2"
       inkscape:connector-curvature="0"
       style="fill:#00579d" /><path
       d="m 271.524,197.642 c -17.253,0 -29.665,-4.39 -36.89,-13.049 -6.434,-7.711 -8.456,-18.438 -6.009,-31.878 L 252.194,23.4 h 37.28 l -24.03,131.862 c -0.853,4.679 -0.407,8.104 1.325,10.18 1.752,2.101 5.128,3.165 10.035,3.165 10.161,0 15.49,-4.387 17.28,-14.224 L 317.957,23.4 h 35.518 l -23.722,130.194 c -5.18,28.405 -25.859,44.048 -58.229,44.048 z"
       id="path4"
       inkscape:connector-curvature="0"
       style="fill:#00579d" /><path
       d="M 452.206,35.562 C 445.378,27.375 432.872,23.395 413.975,23.395 H 363.2 l -31.354,172.087 h 37.27 l 12.411,-68.059 h 9.106 c 6.761,0 11.125,1.293 13.343,3.951 2.284,2.738 2.778,7.452 1.51,14.407 l -4.795,26.266 c -2.524,13.869 -1.85,16.823 -0.826,21.295 l 0.488,2.14 h 38.252 l -1.098,-3.238 c -1.94,-5.727 -1.159,-11.271 0.256,-19.075 l 4.706,-25.795 c 2.146,-11.759 3.04,-27.73 -11.729,-35.911 13.231,-6.252 21.136,-17.29 24.1,-33.592 l 2.395,-13.124 c 2.33,-12.788 0.686,-22.333 -5.029,-29.185 z M 419.65,66.49 416.64,82.976 c -1.998,10.976 -8.035,15.656 -20.184,15.656 h -9.688 l 8.472,-46.444 h 13.514 c 4.83,0 7.996,0.979 9.679,2.996 1.81,2.167 2.208,5.866 1.217,11.306 z"
       id="path6"
       inkscape:connector-curvature="0"
       style="fill:#00579d" /><path
       d="m 490.253,197.396 c -17.255,0 -29.666,-4.39 -36.889,-13.047 -6.434,-7.709 -8.452,-18.433 -6.005,-31.874 l 2.243,-12.276 h 35.512 l -2.704,14.824 c -0.853,4.683 -0.404,8.109 1.329,10.188 1.753,2.102 5.129,3.167 10.032,3.167 10.162,0 15.491,-4.391 17.277,-14.232 1.847,-10.104 -0.758,-18.132 -20.116,-33.966 -23.341,-19.223 -30.616,-34.031 -26.855,-54.643 5.178,-28.404 25.646,-44.048 57.634,-44.048 16.979,0 29.205,4.336 36.339,12.885 6.433,7.708 8.442,18.488 5.977,32.042 l -1.328,7.268 H 527.19 l 1.78,-9.815 c 0.9,-4.938 0.474,-8.5 -1.271,-10.593 -1.682,-2.016 -4.771,-2.995 -9.447,-2.995 -9.756,0 -14.921,4.462 -16.746,14.466 -1.839,10.104 0.77,18.132 20.126,33.967 23.338,19.217 30.614,34.024 26.854,54.643 -5.189,28.398 -25.87,44.039 -58.233,44.039 z"
       id="path8"
       inkscape:connector-curvature="0"
       style="fill:#00579d" /><path
       d="m 613.053,195.481 h -37.276 l 26.11,-143.293 h -33.769 l 5.26,-28.789 h 104.796 l -5.248,28.789 h -33.757 z"
       id="path10"
       inkscape:connector-curvature="0"
       style="fill:#00579d" /></g><g
     id="g4536"
     transform="translate(0,-18.988007)"><g
       aria-label="Coupon"
       transform="matrix(1.0828382,0,-0.16283779,0.92349901,-63.919715,22.798221)"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:65.24863434px;line-height:1.25;font-family:'Christmas Card';-inkscape-font-specification:'Christmas Card';letter-spacing:0px;word-spacing:0px;fill:#00579d;fill-opacity:1;stroke:none;stroke-width:1.63121581"
       id="text4498"><path
         d="m 224.70225,187.20592 q -5.15465,0 -7.89509,-2.93619 -2.67519,-2.93618 -2.67519,-8.28657 v -24.53349 q 0,-5.35039 2.67519,-8.28658 2.74044,-2.93618 7.89509,-2.93618 5.15464,0 7.82983,2.93618 2.74044,2.93619 2.74044,8.28658 v 4.8284 h -6.78585 v -5.28514 q 0,-4.24116 -3.58868,-4.24116 -3.58867,0 -3.58867,4.24116 v 25.51222 q 0,4.17591 3.58867,4.17591 3.58868,0 3.58868,-4.17591 v -6.98161 h 6.78585 v 6.45962 q 0,5.35039 -2.74044,8.28657 -2.67519,2.93619 -7.82983,2.93619 z"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-family:'Bebas Neue';-inkscape-font-specification:'Bebas Neue';fill:#00579d;fill-opacity:1;stroke-width:1.63121581"
         id="path4538"
         inkscape:connector-curvature="0" /><path
         d="m 250.06867,187.20592 q -5.28514,0 -8.09083,-3.00143 -2.80569,-3.00144 -2.80569,-8.48233 v -24.01149 q 0,-5.48089 2.80569,-8.48233 2.80569,-3.00143 8.09083,-3.00143 5.28514,0 8.09083,3.00143 2.80569,3.00144 2.80569,8.48233 v 24.01149 q 0,5.48089 -2.80569,8.48233 -2.80569,3.00143 -8.09083,3.00143 z m 0,-6.52486 q 3.71917,0 3.71917,-4.50216 v -24.92497 q 0,-4.50216 -3.71917,-4.50216 -3.71917,0 -3.71917,4.50216 v 24.92497 q 0,4.50216 3.71917,4.50216 z"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-family:'Bebas Neue';-inkscape-font-specification:'Bebas Neue';fill:#00579d;fill-opacity:1;stroke-width:1.63121581"
         id="path4540"
         inkscape:connector-curvature="0" /><path
         d="m 276.25886,187.20592 q -5.21989,0 -7.96033,-2.93619 -2.74044,-3.00143 -2.74044,-8.54757 v -34.84277 h 7.17735 v 35.36476 q 0,2.34895 0.91348,3.39293 0.97873,1.04398 2.74044,1.04398 1.76171,0 2.67519,-1.04398 0.97873,-1.04398 0.97873,-3.39293 v -35.36476 h 6.91636 v 34.84277 q 0,5.54614 -2.74044,8.54757 -2.74045,2.93619 -7.96034,2.93619 z"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-family:'Bebas Neue';-inkscape-font-specification:'Bebas Neue';fill:#00579d;fill-opacity:1;stroke-width:1.63121581"
         id="path4542"
         inkscape:connector-curvature="0" /><path
         d="m 292.07146,140.87939 h 10.57028 q 5.35039,0 8.02559,2.87094 2.67519,2.87094 2.67519,8.41708 v 4.50215 q 0,5.54614 -2.67519,8.41708 -2.6752,2.87094 -8.02559,2.87094 h -3.39293 v 18.59586 h -7.17735 z m 10.57028,20.55332 q 1.76172,0 2.60995,-0.97873 0.91348,-0.97873 0.91348,-3.32768 v -5.41563 q 0,-2.34896 -0.91348,-3.32768 -0.84823,-0.97873 -2.60995,-0.97873 h -3.39293 v 14.02845 z"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-family:'Bebas Neue';-inkscape-font-specification:'Bebas Neue';fill:#00579d;fill-opacity:1;stroke-width:1.63121581"
         id="path4544"
         inkscape:connector-curvature="0" /><path
         d="m 327.67886,187.20592 q -5.28514,0 -8.09083,-3.00143 -2.80569,-3.00144 -2.80569,-8.48233 v -24.01149 q 0,-5.48089 2.80569,-8.48233 2.80569,-3.00143 8.09083,-3.00143 5.28514,0 8.09083,3.00143 2.80569,3.00144 2.80569,8.48233 v 24.01149 q 0,5.48089 -2.80569,8.48233 -2.80569,3.00143 -8.09083,3.00143 z m 0,-6.52486 q 3.71917,0 3.71917,-4.50216 v -24.92497 q 0,-4.50216 -3.71917,-4.50216 -3.71917,0 -3.71917,4.50216 v 24.92497 q 0,4.50216 3.71917,4.50216 z"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-family:'Bebas Neue';-inkscape-font-specification:'Bebas Neue';fill:#00579d;fill-opacity:1;stroke-width:1.63121581"
         id="path4546"
         inkscape:connector-curvature="0" /><path
         d="m 343.42927,140.87939 h 9.00431 l 6.9816,27.33918 h 0.1305 v -27.33918 h 6.39437 v 45.67405 h -7.3731 l -8.61282,-33.34206 h -0.1305 v 33.34206 h -6.39436 z"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-family:'Bebas Neue';-inkscape-font-specification:'Bebas Neue';fill:#00579d;fill-opacity:1;stroke-width:1.63121581"
         id="path4548"
         inkscape:connector-curvature="0" /></g></g><g
     id="layer1"
     transform="matrix(0,-1.164617,1.164617,0,-834.61664,177.62673)"
     style="fill:#00579d;fill-opacity:1"><g
       id="g4593"
       transform="matrix(4.2610846,-1.2351263,1.2351263,4.2610846,-1337.7659,-2994.9736)"
       style="fill:#00579d;fill-opacity:1"><path
         style="fill:#00579d;fill-opacity:1;marker-start:none"
         id="path4599"
         d="m 59.731665,956.40057 c -0.609784,-1.39286 -2.303491,-1.83556 -3.698902,-1.71226 l -8.742604,0.69566 c -1.935736,-1.91425 -4.307466,-2.2049 -4.132136,-2.81651 0.137044,-0.47806 0.545993,-0.24745 0.837105,-1.51102 0.279511,-1.21323 -0.714709,-2.45509 -1.916471,-2.71488 -1.177727,-0.34526 -2.659814,0.20827 -3.027677,1.45195 -0.447882,1.23061 0.273869,2.69969 1.499535,3.14003 1.400938,0.6374 4.246607,0.49379 4.837778,3.02096 -1.384807,1.41129 -2.993148,0.95525 -4.422137,0.4551 -1.186382,-0.41524 -2.734347,-0.48487 -3.649629,0.53589 -0.881717,0.97694 -0.800158,2.7506 0.376675,3.46434 1.15277,0.8421 3.093263,0.7518 3.824279,-0.64172 0.563472,-1.07414 -0.09119,-1.84242 0.337995,-2.16796 0.32384,-0.24563 1.759155,0.36194 4.749906,-0.0686 l 7.684693,5.46398 c 0.993719,0.61119 2.316503,0.97947 3.577814,0.19164 l -7.902726,-5.8909 9.766502,-0.89574 z m -17.075242,-6.87194 c 1.045256,1.05155 0.403306,2.90727 -0.994512,2.90157 -1.286163,0.072 -2.454591,-1.49318 -1.718425,-2.65375 0.516476,-0.97737 1.997384,-0.96769 2.712937,-0.24782 z m -2.155235,7.72245 c 1.161058,0.85179 0.310724,2.98566 -1.0944,2.9024 -0.962958,0.053 -2.089598,-0.7434 -1.882399,-1.80058 0.188897,-1.30347 1.988129,-2.01427 2.976799,-1.10182 z"
         inkscape:connector-curvature="0" /></g></g><path
     style="fill:none;stroke:#00579d;stroke-width:4.5999999;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:13.8, 4.6;stroke-dashoffset:0;stroke-opacity:1"
     d="M 356.16023,90.843163 V 29.050811 H 44.013285"
     id="path4532"
     inkscape:connector-curvature="0" /></svg>
	 
    <p><b>Version 2</b></p>
    <p>Select a node and complete this form to claim the coupon.</p>
    <hr>

	<label for="node"><b>Node</b></label>	
	<select name="wallet" id="wallet">
		<option value="https://wallet1.burst-team.us:2083/">burst-team.us</option>
		<option value="http://127.0.0.1:8125/">localhost</option>
		<option value="http://testnet.getburst.net:6876/">testnet.getburst.net [TESTNET]</option>
	</select>

    <label for="coupon_code"><b>Coupon code</b></label>	
    <input type="text" placeholder="Enter Coupon Code" name="coupon_code" id="coupon_code" required>

    <label for="psw"><b>Password</b></label>
    <input type="password" placeholder="Enter Coupon Password" name="coupon_pw" required>

   <p>A correct password will broadcast the transaction and opens a new window with the transaction details.</br>Leave the password field empty to only view the the transaction details.</p>

    <div class="clearfix">
      <button type="button" onclick="RedeemFunction()" class="signupbtn">Claim</button>
    </div>
	<p class="error_msg" id="result_output"></p>
	<p class="copyright">© CurbShifter 2018<br>released under GNU General Public License v3.<br><a href="https://github.com/CurbShifter/BurstHotWallet">https://github.com/CurbShifter/BurstHotWallet</a></p>
  </div>
</form>
<script>

function findGetParameter(parameterName) {
    var result = null,
        tmp = [];
    location.search
        .substr(1)
        .split("&")
        .forEach(function (item) {
          tmp = item.split("=");
          if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
        });
    return result;
}
console.log(location.search.substr(8));
document.getElementById("coupon_code").value=location.search.substr(8);

/** conversion functions *****************************************************************************/
function toByteArray(hexString) {
  var result = [];
  while (hexString.length >= 2) {
    result.push(parseInt(hexString.substring(0, 2), 16));
    hexString = hexString.substring(2, hexString.length);
  }
  return result;
}

function toHexString(byteArray) {
  return Array.from(byteArray, function(byte) {
    return ('0' + (byte & 0xFF).toString(16)).slice(-2);
  }).join('')
}

function hexToBase64(str) {
  return btoa(String.fromCharCode.apply(null,
    str.replace(/\r|\n/g, "").replace(/([\da-fA-F]{2}) ?/g, "0x$1 ").replace(/ +$/, "").split(" "))
  );
}

function base64ToHex(str) {
  for (var i = 0, bin = atob(str.replace(/[ \r\n]+$/, "")), hex = []; i < bin.length; ++i) {
    var tmp = bin.charCodeAt(i).toString(16);
    if (tmp.length === 1) tmp = "0" + tmp;
    hex[hex.length] = tmp;
  }
  return hex.join("");
}

function hex2a(hexx) {
    var hex = hexx.toString();//force conversion
    var str = '';
    for (var i = 0; (i < hex.length 
		//&& hex.substr(i, 2) !== '00' //
		); i += 2)
        str += String.fromCharCode(parseInt(hex.substr(i, 2), 16));
    return str;
}

function a2hex(str) {
	var arr = [];
	for (var i = 0, l = str.length; i < l; i ++) {
		var hex = Number(str.charCodeAt(i)).toString(16);
		arr.push(hex.length > 1 && hex || "0" + hex);
	}
  return arr.join('');
}

/*******************************************************************************/
function RedeemFunction() {
	var x = document.getElementById("startform");	
	var walletUrl = x.elements[0].value;
	var couponCodeB64 = x.elements[1].value;
	var password = x.elements[2].value;

	var txHex = DecryptCoupon(couponCodeB64, password);
	console.log("txHex:" + txHex);

	if(txHex.length > 0)
	{
		if(password.length > 0)
		{
			var postdata = {requestType: 'broadcastTransaction', transactionBytes: txHex};
			post(walletUrl + "burst", postdata, "post");
				
			resultText = 'The coupon has been send to the selected node !<p>A window with the raw transation details should have opened.<br>If any error occured then try again using another node. The coupon can be expired.</p>';
		}
		else
		{
			var postdata = {requestType: 'parseTransaction', transactionBytes: txHex};
			post(walletUrl + "burst", postdata, "post");
			
			resultText = 'A window with the parsed transation details should have opened. It has not been claimed ! But you can view the transaction details.<br>If any error occured then try again using another node.</p>';
		}
	}
	else
	{
		resultText = 'unable to decrypt the coupon !';
	}
	document.getElementById("result_output").innerHTML = resultText;
}

function DecryptCoupon(couponCodeB64, password) {
	var shaHex = sha256(password);
	var shaBytes = toByteArray(shaHex);	
	var bf = new Blowfish(shaBytes, "cbc");	
				
	// TODO. chance steps : base64 to bin (without hex)
	var couponHex = base64ToHex(couponCodeB64); // decode coupon from base64 to hex
	//console.log("couponHex:" + couponHex);
	var encryptedSignatureHex = couponHex.substring(couponHex.length - (80 * 2)); // get last 80 bytes, is a nonce + 64byte signature
	//console.log("encryptedSignatureHex:" + encryptedSignatureHex);
	var encryptedSignatureString = hex2a(encryptedSignatureHex);
	// decrypt the signature
	//console.log("encryptedSignatureString.length " + encryptedSignatureString.length);
	var decryptedSignature = bf.decrypt(encryptedSignatureString.substring(8), encryptedSignatureString.substring(0, 8)); 
	var decryptedSignatureHex = a2hex(decryptedSignature).substring(0, 64 * 2);
	//console.log("decryptedSignatureHex:" + decryptedSignatureHex);
	
	if(decryptedSignatureHex.length == 64 * 2 && password.length > 0)
	{
		// insert signature byte 96 to 160
		var txHex = couponHex.substring(0, 96 * 2) + decryptedSignatureHex + couponHex.substring(96 * 2, couponHex.length - (80 * 2));

		var resultText = 'invalid coupon or password !';
		var re = /[0-9A-Fa-f]{6}/g;
		if(re.test(txHex)) // if only hex
		{
			return txHex;
		}
	}
	else 
	{
		if (password.length > 0)
			window.alert("This page is unable to decrypt this coupon !" + password + "!");
		var zero = '0';
		var txHex = couponHex.substring(0, 96 * 2) + zero.padStart(64 * 2, '0') + couponHex.substring(96 * 2, couponHex.length - (80 * 2));
		return txHex;
	}
}

function post(path, params, method) {
    method = method || "post";

    var newform = document.createElement("form");
    newform.setAttribute("style", "border:0px solid #ccc");	
    newform.setAttribute("method", method);
    newform.setAttribute("action", path);    
	newform.setAttribute("id", "postform");
    newform.setAttribute("name", "postform");
    newform.setAttribute("target", "_blank");

	var divNode = document.createElement("div");
	divNode.setAttribute("class", "container");
	divNode.setAttribute("style", "text-align:center");
	
    for(var key in params) {
        if(params.hasOwnProperty(key)) {
            var hiddenField = document.createElement("input");
            hiddenField.setAttribute("type", "hidden");
            hiddenField.setAttribute("name", key);
            hiddenField.setAttribute("value", params[key]);

            divNode.appendChild(hiddenField);
        }
    }
	var hiddenField = document.createElement("p");
	hiddenField.setAttribute("id", "result_output");
	divNode.appendChild(hiddenField);
	
	newform.appendChild(divNode);

	// need to swap the forms before submitting
    var oldform = document.body.removeChild(startform);
	    
	document.body.appendChild(newform);    
	
	newform.submit();
}
/*
function Get(url) {
	var Httpreq = new XMLHttpRequest();
	Httpreq.open("GET", url, false);
	Httpreq.send(null);
	return Httpreq.responseText;
}

function Broadcast(url, args) {
	console.log(url + " POST " + args);
	var xhr = new XMLHttpRequest();
	xhr.open("POST", url, true);
	xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"); //Send the proper header information along

	xhr.onreadystatechange = function() {//Call a function when the state changes.
		if(this.readyState == XMLHttpRequest.DONE && this.status == 200) {			
			var responseJSON = JSON.parse(this.responseText);// Request finished. Do processing here.
			alert(this.responseText);
		}
	}
	xhr.send(args);
}
*/
 
/***************************************************************************
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.9.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */
/*jslint bitwise: true */
(function () {
  'use strict';

  var ERROR = 'input is invalid type';
  var WINDOW = typeof window === 'object';
  var root = WINDOW ? window : {};
  if (root.JS_SHA256_NO_WINDOW) {
    WINDOW = false;
  }
  var WEB_WORKER = !WINDOW && typeof self === 'object';
  var NODE_JS = !root.JS_SHA256_NO_NODE_JS && typeof process === 'object' && process.versions && process.versions.node;
  if (NODE_JS) {
    root = global;
  } else if (WEB_WORKER) {
    root = self;
  }
  var COMMON_JS = !root.JS_SHA256_NO_COMMON_JS && typeof module === 'object' && module.exports;
  var AMD = typeof define === 'function' && define.amd;
  var ARRAY_BUFFER = !root.JS_SHA256_NO_ARRAY_BUFFER && typeof ArrayBuffer !== 'undefined';
  var HEX_CHARS = '0123456789abcdef'.split('');
  var EXTRA = [-2147483648, 8388608, 32768, 128];
  var SHIFT = [24, 16, 8, 0];
  var K = [
    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2
  ];
  var OUTPUT_TYPES = ['hex', 'array', 'digest', 'arrayBuffer'];

  var blocks = [];

  if (root.JS_SHA256_NO_NODE_JS || !Array.isArray) {
    Array.isArray = function (obj) {
      return Object.prototype.toString.call(obj) === '[object Array]';
    };
  }

  if (ARRAY_BUFFER && (root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW || !ArrayBuffer.isView)) {
    ArrayBuffer.isView = function (obj) {
      return typeof obj === 'object' && obj.buffer && obj.buffer.constructor === ArrayBuffer;
    };
  }

  var createOutputMethod = function (outputType, is224) {
    return function (message) {
      return new Sha256(is224, true).update(message)[outputType]();
    };
  };

  var createMethod = function (is224) {
    var method = createOutputMethod('hex', is224);
    if (NODE_JS) {
      method = nodeWrap(method, is224);
    }
    method.create = function () {
      return new Sha256(is224);
    };
    method.update = function (message) {
      return method.create().update(message);
    };
    for (var i = 0; i < OUTPUT_TYPES.length; ++i) {
      var type = OUTPUT_TYPES[i];
      method[type] = createOutputMethod(type, is224);
    }
    return method;
  };

  var nodeWrap = function (method, is224) {
    var crypto = eval("require('crypto')");
    var Buffer = eval("require('buffer').Buffer");
    var algorithm = is224 ? 'sha224' : 'sha256';
    var nodeMethod = function (message) {
      if (typeof message === 'string') {
        return crypto.createHash(algorithm).update(message, 'utf8').digest('hex');
      } else {
        if (message === null || message === undefined) {
          throw new Error(ERROR);
        } else if (message.constructor === ArrayBuffer) {
          message = new Uint8Array(message);
        }
      }
      if (Array.isArray(message) || ArrayBuffer.isView(message) ||
        message.constructor === Buffer) {
        return crypto.createHash(algorithm).update(new Buffer(message)).digest('hex');
      } else {
        return method(message);
      }
    };
    return nodeMethod;
  };

  var createHmacOutputMethod = function (outputType, is224) {
    return function (key, message) {
      return new HmacSha256(key, is224, true).update(message)[outputType]();
    };
  };

  var createHmacMethod = function (is224) {
    var method = createHmacOutputMethod('hex', is224);
    method.create = function (key) {
      return new HmacSha256(key, is224);
    };
    method.update = function (key, message) {
      return method.create(key).update(message);
    };
    for (var i = 0; i < OUTPUT_TYPES.length; ++i) {
      var type = OUTPUT_TYPES[i];
      method[type] = createHmacOutputMethod(type, is224);
    }
    return method;
  };

  function Sha256(is224, sharedMemory) {
    if (sharedMemory) {
      blocks[0] = blocks[16] = blocks[1] = blocks[2] = blocks[3] =
        blocks[4] = blocks[5] = blocks[6] = blocks[7] =
        blocks[8] = blocks[9] = blocks[10] = blocks[11] =
        blocks[12] = blocks[13] = blocks[14] = blocks[15] = 0;
      this.blocks = blocks;
    } else {
      this.blocks = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    }

    if (is224) {
      this.h0 = 0xc1059ed8;
      this.h1 = 0x367cd507;
      this.h2 = 0x3070dd17;
      this.h3 = 0xf70e5939;
      this.h4 = 0xffc00b31;
      this.h5 = 0x68581511;
      this.h6 = 0x64f98fa7;
      this.h7 = 0xbefa4fa4;
    } else { // 256
      this.h0 = 0x6a09e667;
      this.h1 = 0xbb67ae85;
      this.h2 = 0x3c6ef372;
      this.h3 = 0xa54ff53a;
      this.h4 = 0x510e527f;
      this.h5 = 0x9b05688c;
      this.h6 = 0x1f83d9ab;
      this.h7 = 0x5be0cd19;
    }

    this.block = this.start = this.bytes = this.hBytes = 0;
    this.finalized = this.hashed = false;
    this.first = true;
    this.is224 = is224;
  }

  Sha256.prototype.update = function (message) {
    if (this.finalized) {
      return;
    }
    var notString, type = typeof message;
    if (type !== 'string') {
      if (type === 'object') {
        if (message === null) {
          throw new Error(ERROR);
        } else if (ARRAY_BUFFER && message.constructor === ArrayBuffer) {
          message = new Uint8Array(message);
        } else if (!Array.isArray(message)) {
          if (!ARRAY_BUFFER || !ArrayBuffer.isView(message)) {
            throw new Error(ERROR);
          }
        }
      } else {
        throw new Error(ERROR);
      }
      notString = true;
    }
    var code, index = 0, i, length = message.length, blocks = this.blocks;

    while (index < length) {
      if (this.hashed) {
        this.hashed = false;
        blocks[0] = this.block;
        blocks[16] = blocks[1] = blocks[2] = blocks[3] =
          blocks[4] = blocks[5] = blocks[6] = blocks[7] =
          blocks[8] = blocks[9] = blocks[10] = blocks[11] =
          blocks[12] = blocks[13] = blocks[14] = blocks[15] = 0;
      }

      if (notString) {
        for (i = this.start; index < length && i < 64; ++index) {
          blocks[i >> 2] |= message[index] << SHIFT[i++ & 3];
        }
      } else {
        for (i = this.start; index < length && i < 64; ++index) {
          code = message.charCodeAt(index);
          if (code < 0x80) {
            blocks[i >> 2] |= code << SHIFT[i++ & 3];
          } else if (code < 0x800) {
            blocks[i >> 2] |= (0xc0 | (code >> 6)) << SHIFT[i++ & 3];
            blocks[i >> 2] |= (0x80 | (code & 0x3f)) << SHIFT[i++ & 3];
          } else if (code < 0xd800 || code >= 0xe000) {
            blocks[i >> 2] |= (0xe0 | (code >> 12)) << SHIFT[i++ & 3];
            blocks[i >> 2] |= (0x80 | ((code >> 6) & 0x3f)) << SHIFT[i++ & 3];
            blocks[i >> 2] |= (0x80 | (code & 0x3f)) << SHIFT[i++ & 3];
          } else {
            code = 0x10000 + (((code & 0x3ff) << 10) | (message.charCodeAt(++index) & 0x3ff));
            blocks[i >> 2] |= (0xf0 | (code >> 18)) << SHIFT[i++ & 3];
            blocks[i >> 2] |= (0x80 | ((code >> 12) & 0x3f)) << SHIFT[i++ & 3];
            blocks[i >> 2] |= (0x80 | ((code >> 6) & 0x3f)) << SHIFT[i++ & 3];
            blocks[i >> 2] |= (0x80 | (code & 0x3f)) << SHIFT[i++ & 3];
          }
        }
      }

      this.lastByteIndex = i;
      this.bytes += i - this.start;
      if (i >= 64) {
        this.block = blocks[16];
        this.start = i - 64;
        this.hash();
        this.hashed = true;
      } else {
        this.start = i;
      }
    }
    if (this.bytes > 4294967295) {
      this.hBytes += this.bytes / 4294967296 << 0;
      this.bytes = this.bytes % 4294967296;
    }
    return this;
  };

  Sha256.prototype.finalize = function () {
    if (this.finalized) {
      return;
    }
    this.finalized = true;
    var blocks = this.blocks, i = this.lastByteIndex;
    blocks[16] = this.block;
    blocks[i >> 2] |= EXTRA[i & 3];
    this.block = blocks[16];
    if (i >= 56) {
      if (!this.hashed) {
        this.hash();
      }
      blocks[0] = this.block;
      blocks[16] = blocks[1] = blocks[2] = blocks[3] =
        blocks[4] = blocks[5] = blocks[6] = blocks[7] =
        blocks[8] = blocks[9] = blocks[10] = blocks[11] =
        blocks[12] = blocks[13] = blocks[14] = blocks[15] = 0;
    }
    blocks[14] = this.hBytes << 3 | this.bytes >>> 29;
    blocks[15] = this.bytes << 3;
    this.hash();
  };

  Sha256.prototype.hash = function () {
    var a = this.h0, b = this.h1, c = this.h2, d = this.h3, e = this.h4, f = this.h5, g = this.h6,
      h = this.h7, blocks = this.blocks, j, s0, s1, maj, t1, t2, ch, ab, da, cd, bc;

    for (j = 16; j < 64; ++j) {
      // rightrotate
      t1 = blocks[j - 15];
      s0 = ((t1 >>> 7) | (t1 << 25)) ^ ((t1 >>> 18) | (t1 << 14)) ^ (t1 >>> 3);
      t1 = blocks[j - 2];
      s1 = ((t1 >>> 17) | (t1 << 15)) ^ ((t1 >>> 19) | (t1 << 13)) ^ (t1 >>> 10);
      blocks[j] = blocks[j - 16] + s0 + blocks[j - 7] + s1 << 0;
    }

    bc = b & c;
    for (j = 0; j < 64; j += 4) {
      if (this.first) {
        if (this.is224) {
          ab = 300032;
          t1 = blocks[0] - 1413257819;
          h = t1 - 150054599 << 0;
          d = t1 + 24177077 << 0;
        } else {
          ab = 704751109;
          t1 = blocks[0] - 210244248;
          h = t1 - 1521486534 << 0;
          d = t1 + 143694565 << 0;
        }
        this.first = false;
      } else {
        s0 = ((a >>> 2) | (a << 30)) ^ ((a >>> 13) | (a << 19)) ^ ((a >>> 22) | (a << 10));
        s1 = ((e >>> 6) | (e << 26)) ^ ((e >>> 11) | (e << 21)) ^ ((e >>> 25) | (e << 7));
        ab = a & b;
        maj = ab ^ (a & c) ^ bc;
        ch = (e & f) ^ (~e & g);
        t1 = h + s1 + ch + K[j] + blocks[j];
        t2 = s0 + maj;
        h = d + t1 << 0;
        d = t1 + t2 << 0;
      }
      s0 = ((d >>> 2) | (d << 30)) ^ ((d >>> 13) | (d << 19)) ^ ((d >>> 22) | (d << 10));
      s1 = ((h >>> 6) | (h << 26)) ^ ((h >>> 11) | (h << 21)) ^ ((h >>> 25) | (h << 7));
      da = d & a;
      maj = da ^ (d & b) ^ ab;
      ch = (h & e) ^ (~h & f);
      t1 = g + s1 + ch + K[j + 1] + blocks[j + 1];
      t2 = s0 + maj;
      g = c + t1 << 0;
      c = t1 + t2 << 0;
      s0 = ((c >>> 2) | (c << 30)) ^ ((c >>> 13) | (c << 19)) ^ ((c >>> 22) | (c << 10));
      s1 = ((g >>> 6) | (g << 26)) ^ ((g >>> 11) | (g << 21)) ^ ((g >>> 25) | (g << 7));
      cd = c & d;
      maj = cd ^ (c & a) ^ da;
      ch = (g & h) ^ (~g & e);
      t1 = f + s1 + ch + K[j + 2] + blocks[j + 2];
      t2 = s0 + maj;
      f = b + t1 << 0;
      b = t1 + t2 << 0;
      s0 = ((b >>> 2) | (b << 30)) ^ ((b >>> 13) | (b << 19)) ^ ((b >>> 22) | (b << 10));
      s1 = ((f >>> 6) | (f << 26)) ^ ((f >>> 11) | (f << 21)) ^ ((f >>> 25) | (f << 7));
      bc = b & c;
      maj = bc ^ (b & d) ^ cd;
      ch = (f & g) ^ (~f & h);
      t1 = e + s1 + ch + K[j + 3] + blocks[j + 3];
      t2 = s0 + maj;
      e = a + t1 << 0;
      a = t1 + t2 << 0;
    }

    this.h0 = this.h0 + a << 0;
    this.h1 = this.h1 + b << 0;
    this.h2 = this.h2 + c << 0;
    this.h3 = this.h3 + d << 0;
    this.h4 = this.h4 + e << 0;
    this.h5 = this.h5 + f << 0;
    this.h6 = this.h6 + g << 0;
    this.h7 = this.h7 + h << 0;
  };

  Sha256.prototype.hex = function () {
    this.finalize();

    var h0 = this.h0, h1 = this.h1, h2 = this.h2, h3 = this.h3, h4 = this.h4, h5 = this.h5,
      h6 = this.h6, h7 = this.h7;

    var hex = HEX_CHARS[(h0 >> 28) & 0x0F] + HEX_CHARS[(h0 >> 24) & 0x0F] +
      HEX_CHARS[(h0 >> 20) & 0x0F] + HEX_CHARS[(h0 >> 16) & 0x0F] +
      HEX_CHARS[(h0 >> 12) & 0x0F] + HEX_CHARS[(h0 >> 8) & 0x0F] +
      HEX_CHARS[(h0 >> 4) & 0x0F] + HEX_CHARS[h0 & 0x0F] +
      HEX_CHARS[(h1 >> 28) & 0x0F] + HEX_CHARS[(h1 >> 24) & 0x0F] +
      HEX_CHARS[(h1 >> 20) & 0x0F] + HEX_CHARS[(h1 >> 16) & 0x0F] +
      HEX_CHARS[(h1 >> 12) & 0x0F] + HEX_CHARS[(h1 >> 8) & 0x0F] +
      HEX_CHARS[(h1 >> 4) & 0x0F] + HEX_CHARS[h1 & 0x0F] +
      HEX_CHARS[(h2 >> 28) & 0x0F] + HEX_CHARS[(h2 >> 24) & 0x0F] +
      HEX_CHARS[(h2 >> 20) & 0x0F] + HEX_CHARS[(h2 >> 16) & 0x0F] +
      HEX_CHARS[(h2 >> 12) & 0x0F] + HEX_CHARS[(h2 >> 8) & 0x0F] +
      HEX_CHARS[(h2 >> 4) & 0x0F] + HEX_CHARS[h2 & 0x0F] +
      HEX_CHARS[(h3 >> 28) & 0x0F] + HEX_CHARS[(h3 >> 24) & 0x0F] +
      HEX_CHARS[(h3 >> 20) & 0x0F] + HEX_CHARS[(h3 >> 16) & 0x0F] +
      HEX_CHARS[(h3 >> 12) & 0x0F] + HEX_CHARS[(h3 >> 8) & 0x0F] +
      HEX_CHARS[(h3 >> 4) & 0x0F] + HEX_CHARS[h3 & 0x0F] +
      HEX_CHARS[(h4 >> 28) & 0x0F] + HEX_CHARS[(h4 >> 24) & 0x0F] +
      HEX_CHARS[(h4 >> 20) & 0x0F] + HEX_CHARS[(h4 >> 16) & 0x0F] +
      HEX_CHARS[(h4 >> 12) & 0x0F] + HEX_CHARS[(h4 >> 8) & 0x0F] +
      HEX_CHARS[(h4 >> 4) & 0x0F] + HEX_CHARS[h4 & 0x0F] +
      HEX_CHARS[(h5 >> 28) & 0x0F] + HEX_CHARS[(h5 >> 24) & 0x0F] +
      HEX_CHARS[(h5 >> 20) & 0x0F] + HEX_CHARS[(h5 >> 16) & 0x0F] +
      HEX_CHARS[(h5 >> 12) & 0x0F] + HEX_CHARS[(h5 >> 8) & 0x0F] +
      HEX_CHARS[(h5 >> 4) & 0x0F] + HEX_CHARS[h5 & 0x0F] +
      HEX_CHARS[(h6 >> 28) & 0x0F] + HEX_CHARS[(h6 >> 24) & 0x0F] +
      HEX_CHARS[(h6 >> 20) & 0x0F] + HEX_CHARS[(h6 >> 16) & 0x0F] +
      HEX_CHARS[(h6 >> 12) & 0x0F] + HEX_CHARS[(h6 >> 8) & 0x0F] +
      HEX_CHARS[(h6 >> 4) & 0x0F] + HEX_CHARS[h6 & 0x0F];
    if (!this.is224) {
      hex += HEX_CHARS[(h7 >> 28) & 0x0F] + HEX_CHARS[(h7 >> 24) & 0x0F] +
        HEX_CHARS[(h7 >> 20) & 0x0F] + HEX_CHARS[(h7 >> 16) & 0x0F] +
        HEX_CHARS[(h7 >> 12) & 0x0F] + HEX_CHARS[(h7 >> 8) & 0x0F] +
        HEX_CHARS[(h7 >> 4) & 0x0F] + HEX_CHARS[h7 & 0x0F];
    }
    return hex;
  };

  Sha256.prototype.toString = Sha256.prototype.hex;

  Sha256.prototype.digest = function () {
    this.finalize();

    var h0 = this.h0, h1 = this.h1, h2 = this.h2, h3 = this.h3, h4 = this.h4, h5 = this.h5,
      h6 = this.h6, h7 = this.h7;

    var arr = [
      (h0 >> 24) & 0xFF, (h0 >> 16) & 0xFF, (h0 >> 8) & 0xFF, h0 & 0xFF,
      (h1 >> 24) & 0xFF, (h1 >> 16) & 0xFF, (h1 >> 8) & 0xFF, h1 & 0xFF,
      (h2 >> 24) & 0xFF, (h2 >> 16) & 0xFF, (h2 >> 8) & 0xFF, h2 & 0xFF,
      (h3 >> 24) & 0xFF, (h3 >> 16) & 0xFF, (h3 >> 8) & 0xFF, h3 & 0xFF,
      (h4 >> 24) & 0xFF, (h4 >> 16) & 0xFF, (h4 >> 8) & 0xFF, h4 & 0xFF,
      (h5 >> 24) & 0xFF, (h5 >> 16) & 0xFF, (h5 >> 8) & 0xFF, h5 & 0xFF,
      (h6 >> 24) & 0xFF, (h6 >> 16) & 0xFF, (h6 >> 8) & 0xFF, h6 & 0xFF
    ];
    if (!this.is224) {
      arr.push((h7 >> 24) & 0xFF, (h7 >> 16) & 0xFF, (h7 >> 8) & 0xFF, h7 & 0xFF);
    }
    return arr;
  };

  Sha256.prototype.array = Sha256.prototype.digest;

  Sha256.prototype.arrayBuffer = function () {
    this.finalize();

    var buffer = new ArrayBuffer(this.is224 ? 28 : 32);
    var dataView = new DataView(buffer);
    dataView.setUint32(0, this.h0);
    dataView.setUint32(4, this.h1);
    dataView.setUint32(8, this.h2);
    dataView.setUint32(12, this.h3);
    dataView.setUint32(16, this.h4);
    dataView.setUint32(20, this.h5);
    dataView.setUint32(24, this.h6);
    if (!this.is224) {
      dataView.setUint32(28, this.h7);
    }
    return buffer;
  };

  function HmacSha256(key, is224, sharedMemory) {
    var i, type = typeof key;
    if (type === 'string') {
      var bytes = [], length = key.length, index = 0, code;
      for (i = 0; i < length; ++i) {
        code = key.charCodeAt(i);
        if (code < 0x80) {
          bytes[index++] = code;
        } else if (code < 0x800) {
          bytes[index++] = (0xc0 | (code >> 6));
          bytes[index++] = (0x80 | (code & 0x3f));
        } else if (code < 0xd800 || code >= 0xe000) {
          bytes[index++] = (0xe0 | (code >> 12));
          bytes[index++] = (0x80 | ((code >> 6) & 0x3f));
          bytes[index++] = (0x80 | (code & 0x3f));
        } else {
          code = 0x10000 + (((code & 0x3ff) << 10) | (key.charCodeAt(++i) & 0x3ff));
          bytes[index++] = (0xf0 | (code >> 18));
          bytes[index++] = (0x80 | ((code >> 12) & 0x3f));
          bytes[index++] = (0x80 | ((code >> 6) & 0x3f));
          bytes[index++] = (0x80 | (code & 0x3f));
        }
      }
      key = bytes;
    } else {
      if (type === 'object') {
        if (key === null) {
          throw new Error(ERROR);
        } else if (ARRAY_BUFFER && key.constructor === ArrayBuffer) {
          key = new Uint8Array(key);
        } else if (!Array.isArray(key)) {
          if (!ARRAY_BUFFER || !ArrayBuffer.isView(key)) {
            throw new Error(ERROR);
          }
        }
      } else {
        throw new Error(ERROR);
      }
    }

    if (key.length > 64) {
      key = (new Sha256(is224, true)).update(key).array();
    }

    var oKeyPad = [], iKeyPad = [];
    for (i = 0; i < 64; ++i) {
      var b = key[i] || 0;
      oKeyPad[i] = 0x5c ^ b;
      iKeyPad[i] = 0x36 ^ b;
    }

    Sha256.call(this, is224, sharedMemory);

    this.update(iKeyPad);
    this.oKeyPad = oKeyPad;
    this.inner = true;
    this.sharedMemory = sharedMemory;
  }
  HmacSha256.prototype = new Sha256();

  HmacSha256.prototype.finalize = function () {
    Sha256.prototype.finalize.call(this);
    if (this.inner) {
      this.inner = false;
      var innerHash = this.array();
      Sha256.call(this, this.is224, this.sharedMemory);
      this.update(this.oKeyPad);
      this.update(innerHash);
      Sha256.prototype.finalize.call(this);
    }
  };

  var exports = createMethod();
  exports.sha256 = exports;
  exports.sha224 = createMethod(true);
  exports.sha256.hmac = createHmacMethod();
  exports.sha224.hmac = createHmacMethod(true);

  if (COMMON_JS) {
    module.exports = exports;
  } else {
    root.sha256 = exports.sha256;
    root.sha224 = exports.sha224;
    if (AMD) {
      define(function () {
        return exports;
      });
    }
  }
})();


/*****************************************************************************************************************
 * The MIT License (MIT)
 *
 * Copyright (c) 2017 Alexandr Gorlov
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included
 * in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

/**
 * @class Blowfish
 * @description
 * Шифратор/дешифратор. Алгоритм Blowfish
 * 
 * Browser version. For node use Blowfish.node.js
 *
 * в режиме ecb: исходная строка разбивается на 8-байтные блоки, каждый блок
 *   шифруется. Если размер блока менее 8 байт, то дополняем его до 8 байт нулями.
 * в режиме cbc: первый блок открытого текста, из 8 байт, перед шифрованием побитово
 *   складывается по модулю 2 (операция XOR) с вектором инициализации;
 *   последующие блоки открытого текста побитового складываются (XOR) с предыдущим результатом
 *   шифрования после этого зашифровываются.
 *
 * Подробнее о режимах шифрования:
 * http://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%B6%D0%B8%D0%BC_%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F
 *
 * @example
 * // Пример 1: режим ECB, по умолчанию
 * // Example 1: ECB mode, by default
 * var bf = new Blowfish("secret key");
 * var encrypted = bf.encrypt("конфиденциальное сообщение");
 * var decrypted = bf.decrypt(encrypted);
 *
 * // Пример 2: режим CBC (лучше подходит для шифрования длинных сообщений, более 1kb):
 * // Example 2: CBC mode (better suited for encryption of long messages, more than 1kb):
 * var bf = new Blowfish("key", "cbc");
 * var encrypted = bf.encrypt("secret message", "cbcvecto");
 * var decrypted = bf.decrypt(encrypted, "cbcvecto");
 *
 * //В режиме CBC вектор иницаилазиации iv это дополнительный пароль.
 *
 * // Пример 3:
 * // После шифрования получается бинарная строка. Чтобы передать
 * // зашифрованное сообщение в эл.письме нужно закодировать бинарную
 * // строку в base64
 * // Example 3:
 * // After encryption, a binary string is obtained. To pass on
 * // the encrypted message in the e-letter needs to encode the binary
 * // string in base64
 * var bf = new Blowfish("key");
 *
 * // Для удобства включил, в этот класс методы base64Encode и base64Decode
 * // For convenience, included in this class the methods base64Encode and base64Decode
 * // Шифрование
 * // Encryption
 * var encrypted = bf.base64Encode(bf.encrypt("secret message"));
 *
 * // Расшифрование
 * // Decryption
 * var encrypted = bf.base64Decode(encrypted);
 * var decrypted = bf.decrypt(encrypted);
 *
 * @param {string} key    пароль (может быть длинной до 56 байт)
 * @param {string} [mode] режим шифрования
 * @param {string} key password (can be up to 56 bytes long)
 * @param {string} [mode] encryption mode
 * @author Alexandr Gorlov <a.gorlov@gmail.com>
 */
var Blowfish = function(key, mode) {

  // инициализация пароля
  this.key = key;

  // инициализация режима шифрования
  if (mode === "ecb" || mode === "cbc") {
    this.mode = mode;
  }

  // инициализация массивов с кодами символов (правда ведь?)
  this.sBox0  = Blowfish.sBox0.slice();
  this.sBox1  = Blowfish.sBox1.slice();
  this.sBox2  = Blowfish.sBox2.slice();
  this.sBox3  = Blowfish.sBox3.slice();
  this.pArray = Blowfish.pArray.slice();

  // инициализация шифра
  this.generateSubkeys(key);
};

Blowfish.prototype = {

  /**
   * @type {Array}
   */
  sBox0: null,

  /**
   * @type {Array}
   */
  sBox1: null,

  /**
   * @type {Array}
   */
  sBox2: null,

  /**
   * @type {Array}
   */
  sBox3: null,

  /**
   * @type {Array}
   */
  pArray: null,

  /**
   * Пароль
   * @type {string}
   */
  key: null,

  /**
   * Режим шифрования: ecb|cbc; по умолчанию: ecb
   * @type {string}
   */
  mode: "ecb",

  /**
   * Вектор инициализации для режима cbc
   * @type {string}
   */
  iv:  "abc12345",

  /**
   * Набор символов для base64
   * @type {string}
   */
  keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",

  /**
   * Шифрует строку
   * @param {string} string шифруемая строка
   * @param {string} iv произвольная 8байтная строка - вектор инициализации;
   *                    используется только в режиме CBC
   * @throws {Error} кидает исключение при неизвестном режиме шифрования
   * @return {string} зашифрованная строка
   */
  encrypt: function(string, iv) {
    if (this.mode === "ecb") {
      return this.encryptECB(string);
    }

    if (this.mode === "cbc") {
      return this.encryptCBC(string, iv);
    }

    throw new Error("Неизвестный режим шифрования.");
  },

  /**
   * Расшифровывает строку
   * @param {string} string зашифрованная строка
   * @param {string} iv произвольная 8байтная строка - вектор инициализации
   *                    (должен быть тотже, что и при шифровании) используется
   *                    только в режиме CBC
   * @throws {Error} кидает исключение при неизвестном режиме шифрования
   * @return {string} расшифрованная строка
	
	* Decrypts the string
    * @param {string} string encrypted string
    * @param {string} iv any 8-byte string - initialization vector
    * (should be the same as in encryption) is used
    * only in CBC mode
    * @throws {Error} throws an exception for unknown encryption mode
    * @return {string} decrypted string
   */
  decrypt: function(string, iv) {
    if (this.mode === "ecb") {
      return this.decryptECB(string);
    }

    if (this.mode === "cbc") {
      return this.decryptCBC(string, iv);
    }

    throw new Error("Неизвестный режим шифрования.");
  },

  /**
   * Шифрует в режиме ECB
   * (приватный метод)
   * @param {string} string шифруемая строка
   * @return {string} зашифрованная строка
   */
  encryptECB: function(string) {
    string = this.utf8Decode(string);
    var blocks = Math.ceil(string.length/8);

    //1. разбить строку на 8-байтные блок-и
    //2. разбить 8байтные блоки на 32-битные пары xL, xR
    //3. зашифровать все блоки
    //4. преобразовать результат в строку

    var encryptedString = "";
    for (var i = 0; i < blocks; i++) {
      var block = string.substr(i * 8, 8);
      if (block.length < 8) {
        var count = 8 - block.length;
        while (0 < count--) {
          block += "\0";
        }
      }

      var xL, xR;
      //[xL, xR] = this.split64by32(block); не работает в IE, Chrome
      var xLxR  = this.split64by32(block);
      xL = xLxR[0];
      xR = xLxR[1];

      //[xL, xR] = this.encipher(xL, xR); не работает в IE, Chrome
      xLxR = this.encipher(xL, xR);
      xL = xLxR[0];
      xR = xLxR[1];
      encryptedString += this.num2block32(xL) + this.num2block32(xR);
    }

    return encryptedString;
  },

  /**
   * Шифрует в режиме CBC
   * (приватный метод)
   * @param {string} string шифруемая строка
   * @param {string} iv 8-байтная строка - вектор инициализации
   * @return {string} зашифрованная строка
   */
  encryptCBC: function(string, iv) {
    string = this.utf8Decode(string);
    var blocks = Math.ceil(string.length/8);

    //1. разбить строку на 8-байтные блок-и
    //2. разбить 8байтные блоки на 32-битные пары xL, xR
    //3. зашифровать все блоки
    //4. преобразовать результат в строку

    var ivL, ivR, ivLivR;
    //[ivL, ivR] = this.split64by32(iv);
    ivLivR = this.split64by32(iv);
    ivL = ivLivR[0];
    ivR = ivLivR[1];

    var encryptedString = "";
    for (var i = 0; i < blocks; i++) {
      var block = string.substr(i * 8, 8);
      if (block.length < 8) {
        var count = 8 - block.length;
        while (0 < count--) {
          block += "\0";
        }
      }

      var xL, xR, xLxR;
      xLxR = this.split64by32(block);
      xL = xLxR[0];
      xR = xLxR[1];

      xL = this.xor(xL, ivL);
      xR = this.xor(xR, ivR);

      xLxR = this.encipher(xL, xR);
      xL = xLxR[0];
      xR = xLxR[1];

      ivL = xL;
      ivR = xR;

      encryptedString += this.num2block32(xL) + this.num2block32(xR);
    }

    return encryptedString;
  },

  /**
   * Расшифровать в режиме ECB
   * (приватный метод)
   * @param {string} string шифруемая строка
   * @throws {Error} кидает исключение если зашифрованная строка повреждена
   * @return {string} зашифрованная строка
   */
  decryptECB: function(string) {
    var blocks = Math.ceil(string.length/8);

    var decryptedString = "";
    for (var i = 0; i < blocks; i++) {
      var block = string.substr(i * 8, 8);
      if (block.length < 8) {
        throw new Error("Зашифрованная строка повреждена: длинна зашифрованной строки должна быть кратна 8 баыйтам.");
      }
      var xL, xR, xLxR;

      xLxR = this.split64by32(block);
      xL = xLxR[0];
      xR = xLxR[1];

      xLxR = this.decipher(xL, xR);
      xL = xLxR[0];
      xR = xLxR[1];

      decryptedString += this.num2block32(xL) + this.num2block32(xR);
    }

    decryptedString = this.utf8Encode(decryptedString);
    return decryptedString;
  },

  /**
   * Шифрует в режиме CBC
   * (приватный метод)
   * @param {string} string зашифрованная строка
   * @param {string} iv 8-байтная строка - вектор инициализации
   * @throws {Error} кидает исключение если зашифрованная строка повреждена
   * @return {string} расшифрованая строка
 * Encrypts in CBC mode
    * (private method)
    * @param {string} string encrypted string
    * @param {string} iv 8-byte string - initialization vector
    * @throws {Error} throws an exception if the encrypted string is corrupted
    * @return {string} decrypted string
	*/
  decryptCBC: function(string, iv) {

    var blocks = Math.ceil(string.length/8);

    var ivL, ivR, ivLtmp, ivRtmp, ivLivR;

    ivLivR = this.split64by32(iv);
    ivL = ivLivR[0];
    ivR = ivLivR[1];

    var decryptedString = "";
    for (var i = 0; i < blocks; i++) {
      var block = string.substr(i * 8, 8);
      if (block.length < 8) {
        throw new Error("Зашифрованная строка повреждена: длинна зашифрованной строки должна быть кратна 8 байтам.");
      }
      var xL, xR, xLxR;
      xLxR = this.split64by32(block);
      xL = xLxR[0];
      xR = xLxR[1];

      ivLtmp = xL;
      ivRtmp = xR;

      xLxR = this.decipher(xL, xR);
      xL = xLxR[0];
      xR = xLxR[1];

      xL = this.xor(xL, ivL);
      xR = this.xor(xR, ivR);

      ivL = ivLtmp;
      ivR = ivRtmp;
      decryptedString += this.num2block32(xL) + this.num2block32(xR);
    }

    //decryptedString = this.utf8Encode(decryptedString);
    return decryptedString;
  },

  /**
   * Функция F
   * Function F looks like this:
   * Divide xL into four eight-bit quarters: a, b, c, and d.
   * Then, F(xL) = ((S1,a + S2,b mod 232) XOR S3,c) + S4,d mod 232.
   * F(0xFFFFFF)
   * ((S1[255] + S2[255]) XOR S3[255]) + S4[255]
   * ((0x6e85076a + 0xdb83adf7) ^ 0x406000e0) + 0x3ac372e6
   * @param {int32} xL 32битное значение
   */
  F: function(xL) {
    var a = xL >>> 24;
    var b = xL << 8 >>> 24;
    var c = xL << 16 >>> 24;
    var d = xL << 24 >>> 24;

    var res = this.addMod32(this.sBox0[a], this.sBox1[b]);
    res = this.xor(res, this.sBox2[c]);
    res = this.addMod32(res, this.sBox3[d]);
    return res;
  },

  /**
   * Шифрует строку из 8 байт (один блок)
   * Encryption and Decryption:
   * Blowfish has 16 rounds. The input is a 64-bit data element, x.
   * Divide x into two 32-bit halves: xL, xR. Then, for i = 1 to 16:
   * xL = xL XOR Pi
   * xR = F(xL) XOR xR
   * Swap xL and xR
   * After the sixteenth round, swap xL and xR again to undo the last swap.
   * Then, xR = xR XOR P17 and xL = xL XOR P18. Finally, recombine xL and xR
   * to get the ciphertext.
   * Function F looks like this:
   * Divide xL into four eight-bit quarters: a, b, c, and d.
   * Then, F(xL) = ((S1,a + S2,b mod 232) XOR S3,c) + S4,d mod 232.
   * Decryption is exactly the same as encryption, except that P1, P2,..., P18
   * are used in the reverse order.
   * @param {int32} xL первые 4 символа в виде числа 32битного беззнакового
   * @param {int32} xR оставшиеся 4 символа в виде числа 32битного беззнакового
   * @return {Array} зашифрованный 8-байтный блок в виде пары 32битных чисел [xL, xR]
   */
  encipher: function(xL, xR) {
    var tmp;
    for (var i = 0; i < 16; i++) {
      xL = this.xor(xL, this.pArray[i]);
      xR = this.xor(this.F(xL), xR);
      tmp = xL;
      xL = xR;
      xR = tmp;
    }

    tmp = xL;
    xL = xR;
    xR = tmp;

    xR = this.xor(xR, this.pArray[16]);
    xL = this.xor(xL, this.pArray[17]);

    return [xL, xR];
  },

  /**
   * ??
   * @param {int32} xL
   * @param {int32} xR
   * @return {Array}
   */
  decipher: function(xL, xR) {
    var tmp;

    xL = this.xor(xL, this.pArray[17]);
    xR = this.xor(xR, this.pArray[16]);

    tmp = xL;
    xL = xR;
    xR = tmp;

    for (var i = 15; i >= 0; i--) {
      tmp = xL;
      xL = xR;
      xR = tmp;
      xR = this.xor(this.F(xL), xR);
      xL = this.xor(xL, this.pArray[i]);
    }

    return [xL, xR];
  },

  /**
   * Генерация ключей (subkeys)
   * Generating the Subkeys:
   * The subkeys are calculated using the Blowfish algorithm:
   * 1. Initialize first the P-array and then the four S-boxes, in order,
   *    with a fixed string. This string consists of the hexadecimal digits
   *    of pi (less the initial 3): P1 = 0x243f6a88, P2 = 0x85a308d3,
   *    P3 = 0x13198a2e, P4 = 0x03707344, etc.
   * 2. XOR P1 with the first 32 bits of the key, XOR P2 with the second 32-bits
   *    of the key, and so on for all bits of the key (possibly up to P14).
   *    Repeatedly cycle through the key bits until the entire P-array has
   *    been XORed with key bits. (For every short key, there is at least one
   *    equivalent longer key; for example, if A is a 64-bit key, then AA,
   *    AAA, etc., are equivalent keys.)
   * 3. Encrypt the all-zero string with the Blowfish algorithm, using the
   *    subkeys described in steps (1) and (2).
   * 4. Replace P1 and P2 with the output of step (3).
   * 5. Encrypt the output of step (3) using the Blowfish algorithm with the
   *    modified subkeys.
   * 6. Replace P3 and P4 with the output of step (5).
   * 7. Continue the process, replacing all entries of the P array, and then all
   *    four S-boxes in order, with the output of the continuously changing
   *    Blowfish algorithm.
   * In total, 521 iterations are required to generate all required subkeys.
   * Applications can store the subkeys rather than execute this derivation
   * process multiple times.
   *
   * Долго пытался понять правильную последовательность генерации ключей,
   * в итоге посмотрел как сделано в PHP реализации Crypt_Blowfish (PEAR)
   * и разобрался.
   * @param {string} key ключ
   */
  generateSubkeys: function(key) {
    var data = 0;
    var k = 0;
    var i, j;

    for (i = 0; i < 18; i++) {
      for (j = 4; j > 0; j--) {
        //data = this.fixNegative(data << 8 | key.charCodeAt(k));
        data = this.fixNegative(data << 8 | (key[k]));
        k = (k + 1) % key.length;
      }
      this.pArray[i] = this.xor(this.pArray[i], data);
      data = 0;
    }

    //var block64 = num2block32(0) + num2block32(0);
    var block64 = [0, 0];
    for (i = 0; i < 18; i += 2) {
      block64 = this.encipher(block64[0], block64[1]);
      this.pArray[i] = block64[0];
      this.pArray[i + 1] = block64[1];
    }

    for (i = 0; i < 256; i += 2) {
      block64 = this.encipher(block64[0], block64[1]);
      this.sBox0[i] = block64[0];
      this.sBox0[i + 1] = block64[1];
    }

    for (i = 0; i < 256; i += 2) {
      block64 = this.encipher(block64[0], block64[1]);
      this.sBox1[i] = block64[0];
      this.sBox1[i + 1] = block64[1];
    }

    for (i = 0; i < 256; i += 2) {
      block64 = this.encipher(block64[0], block64[1]);
      this.sBox2[i] = block64[0];
      this.sBox2[i + 1] = block64[1];
    }

    for (i = 0; i < 256; i += 2) {
      block64 = this.encipher(block64[0], block64[1]);
      this.sBox3[i] = block64[0];
      this.sBox3[i + 1] = block64[1];
    }

  },

  /**
   * Преобразует 4х байтную строку, в 32битное целое число
   * @param {string} block32
   * @return {int}
* Converts a 4-byte string to a 32-bit integer
* @param {string} block32
* @return {int}
	*/
  block32toNum: function(block32) {
    return this.fixNegative(
      block32.charCodeAt(0) << 24 |
      block32.charCodeAt(1) << 16 |
      block32.charCodeAt(2) << 8 |
      block32.charCodeAt(3)
      );
  },

  /**
   * Преобразует 32битное число в строку (4 байта)
   * @param {int} num 32 битное число
   * @return {string} 4х-байтная строка
* Converts a 32-bit number to a string (4 bytes)
* @param {int} num 32 bit number
* @return {string} 4-byte string
   */
  num2block32: function(num) {
    return String.fromCharCode(num >>> 24) +
    String.fromCharCode(num << 8 >>> 24) +
    String.fromCharCode(num << 16 >>> 24) +
    String.fromCharCode(num << 24 >>> 24);
  },

  /**
   * Операция XOR
   * @param {int} a
   * @param {int} b
   * @return {int}
   */
  xor: function(a, b) {
    return this.fixNegative(a ^ b);
  },

  /**
   * Сложение по модулю 2^32
   * Складываем 2 числа и отрбрасываем все разряды больше 32
   * @param {int} a
   * @param {int} b
   * @return {int}
   */
  addMod32: function(a, b) {
    return this.fixNegative((a + b) | 0);  // | 0 приводит к 32битному значению
  },

  /**
   * Преобразование signed int в unsigned int
   * после побитовых операций javascript возвращает знаковое число
   * However, for octet-data processing (eg, network stream, etc), usually
   * want the "unsigned int" representation. This can be accomplished by
   * adding a ">>> 0" (zero-fill right-shift) operator which internally tells
   * Javascript to treat this as unsigned.
   * @param {int} number целое число со знаком
   * @return {int} целое число без знака
   */
  fixNegative: function(number) {
    return number >>> 0;
  },

  /**
   * Разделим 64 битный блок на два 32-битных
   * @param {string} block64 блок, состоящий из 64 бит (8 байт)
   * @return {Array} [xL, xR]
* Divide the 64 bit block into two 32-bit ones
* @param {string} block64 block consisting of 64 bits (8 bytes)
* @return {Array} [xL, xR]
   */
  split64by32: function (block64) {
    var xL = block64.substring(0, 4);
    var xR = block64.substring(4, 8);

    return [this.block32toNum(xL) , this.block32toNum(xR)];
  },

  /**
   * Преобразует строку в последовательность байтов utf8
   * на один символ может приходится больше одного байта
   * Взял этот метод из библиотеки base64:
* Converts a string to a sequence of bytes utf8
* one character can have more than one byte
* I took this method from the base64 library:
   * http://www.webtoolkit.info/javascript-base64.html
   */
  utf8Decode: function(string) {
    var utftext = "";
    for (var n = 0; n < string.length; n++) {
      var c = string.charCodeAt(n);
      if (c < 128) {
        utftext += String.fromCharCode(c);
      } else if (c > 127 && c < 2048) {
        utftext += String.fromCharCode(c >> 6 | 192);
        utftext += String.fromCharCode(c & 63 | 128);
      } else {
        utftext += String.fromCharCode(c >> 12 | 224);
        utftext += String.fromCharCode(c >> 6 & 63 | 128);
        utftext += String.fromCharCode(c & 63 | 128);
      }
    }
    return utftext;
  },

  /**
   * Преобразует байтовую-строку utf8 в строку javascript
   * Converts the byte-string utf8 to a javascript string
   */
  utf8Encode: function (utftext) {
    var string = "";
    var i = 0;
    var c = 0;
    var c1 = 0;
    var c2 = 0;

    while ( i < utftext.length ) {

      c = utftext.charCodeAt(i);

      if (c < 128) {
        string += String.fromCharCode(c);
        i++;
      } else if((c > 191) && (c < 224)) {
        c1 = utftext.charCodeAt(i+1);
        string += String.fromCharCode(((c & 31) << 6) | (c1 & 63));
        i += 2;
      } else {
        c1 = utftext.charCodeAt(i+1);
        c2 = utftext.charCodeAt(i+2);
        string += String.fromCharCode(((c & 15) << 12) | ((c1 & 63) << 6) | (c2 & 63));
        i += 3;
      }

    }

    return string;
  },

  /**
   * Кодирует строку в base64
   * @param {string} input
   * @return {string}
   */
  base64Encode : function (input) {
    var output = "";
    var chr1, chr2, chr3, enc1, enc2, enc3, enc4;
    var i = 0;

    //input = this.utf8Encode(input);

    while (i < input.length) {
      chr1 = input.charCodeAt(i++);
      chr2 = input.charCodeAt(i++);
      chr3 = input.charCodeAt(i++);

      enc1 = chr1 >> 2;
      enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
      enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
      enc4 = chr3 & 63;

      if (isNaN(chr2)) {
        enc3 = enc4 = 64;
      } else if (isNaN(chr3)) {
        enc4 = 64;
      }

      output = output +
        this.keyStr.charAt(enc1) + this.keyStr.charAt(enc2) +
        this.keyStr.charAt(enc3) + this.keyStr.charAt(enc4);
    }

    return output;
  },

  /**
   * Раскодирует строку из base64
   * @param {string} input
   * @return {string}
   */
  base64Decode : function (input) {
    var output = "";
    var chr1, chr2, chr3;
    var enc1, enc2, enc3, enc4;
    var i = 0;

    input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");

    while (i < input.length) {

      enc1 = this.keyStr.indexOf(input.charAt(i++));
      enc2 = this.keyStr.indexOf(input.charAt(i++));
      enc3 = this.keyStr.indexOf(input.charAt(i++));
      enc4 = this.keyStr.indexOf(input.charAt(i++));

      chr1 = (enc1 << 2) | (enc2 >> 4);
      chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
      chr3 = ((enc3 & 3) << 6) | enc4;

      output = output + String.fromCharCode(chr1);

      if (enc3 != 64) {
        output = output + String.fromCharCode(chr2);
      }
      if (enc4 != 64) {
        output = output + String.fromCharCode(chr3);
      }
    }
    //output = this.utf8Decode(output);
    return output;
  },

  /**
   * Удаляет символы \0 в конце строки
   * @param {string} input
   * @return {string}
   */
  trimZeros: function(input) {
    return input.replace(/\0+$/g, "");
  }
}

/**
 * @static
 * @type {Array}
 */
Blowfish.pArray = [
  0x243f6a88, 0x85a308d3, 0x13198a2e, 0x03707344, 0xa4093822, 0x299f31d0,
  0x082efa98, 0xec4e6c89, 0x452821e6, 0x38d01377, 0xbe5466cf, 0x34e90c6c,
  0xc0ac29b7, 0xc97c50dd, 0x3f84d5b5, 0xb5470917, 0x9216d5d9, 0x8979fb1b
];

/**
 * @static
 * @type {Array}
 */
Blowfish.sBox0 = [
  0xd1310ba6, 0x98dfb5ac, 0x2ffd72db, 0xd01adfb7, 0xb8e1afed, 0x6a267e96,
  0xba7c9045, 0xf12c7f99, 0x24a19947, 0xb3916cf7, 0x0801f2e2, 0x858efc16,
  0x636920d8, 0x71574e69, 0xa458fea3, 0xf4933d7e, 0x0d95748f, 0x728eb658,
  0x718bcd58, 0x82154aee, 0x7b54a41d, 0xc25a59b5, 0x9c30d539, 0x2af26013,
  0xc5d1b023, 0x286085f0, 0xca417918, 0xb8db38ef, 0x8e79dcb0, 0x603a180e,
  0x6c9e0e8b, 0xb01e8a3e, 0xd71577c1, 0xbd314b27, 0x78af2fda, 0x55605c60,
  0xe65525f3, 0xaa55ab94, 0x57489862, 0x63e81440, 0x55ca396a, 0x2aab10b6,
  0xb4cc5c34, 0x1141e8ce, 0xa15486af, 0x7c72e993, 0xb3ee1411, 0x636fbc2a,
  0x2ba9c55d, 0x741831f6, 0xce5c3e16, 0x9b87931e, 0xafd6ba33, 0x6c24cf5c,
  0x7a325381, 0x28958677, 0x3b8f4898, 0x6b4bb9af, 0xc4bfe81b, 0x66282193,
  0x61d809cc, 0xfb21a991, 0x487cac60, 0x5dec8032, 0xef845d5d, 0xe98575b1,
  0xdc262302, 0xeb651b88, 0x23893e81, 0xd396acc5, 0x0f6d6ff3, 0x83f44239,
  0x2e0b4482, 0xa4842004, 0x69c8f04a, 0x9e1f9b5e, 0x21c66842, 0xf6e96c9a,
  0x670c9c61, 0xabd388f0, 0x6a51a0d2, 0xd8542f68, 0x960fa728, 0xab5133a3,
  0x6eef0b6c, 0x137a3be4, 0xba3bf050, 0x7efb2a98, 0xa1f1651d, 0x39af0176,
  0x66ca593e, 0x82430e88, 0x8cee8619, 0x456f9fb4, 0x7d84a5c3, 0x3b8b5ebe,
  0xe06f75d8, 0x85c12073, 0x401a449f, 0x56c16aa6, 0x4ed3aa62, 0x363f7706,
  0x1bfedf72, 0x429b023d, 0x37d0d724, 0xd00a1248, 0xdb0fead3, 0x49f1c09b,
  0x075372c9, 0x80991b7b, 0x25d479d8, 0xf6e8def7, 0xe3fe501a, 0xb6794c3b,
  0x976ce0bd, 0x04c006ba, 0xc1a94fb6, 0x409f60c4, 0x5e5c9ec2, 0x196a2463,
  0x68fb6faf, 0x3e6c53b5, 0x1339b2eb, 0x3b52ec6f, 0x6dfc511f, 0x9b30952c,
  0xcc814544, 0xaf5ebd09, 0xbee3d004, 0xde334afd, 0x660f2807, 0x192e4bb3,
  0xc0cba857, 0x45c8740f, 0xd20b5f39, 0xb9d3fbdb, 0x5579c0bd, 0x1a60320a,
  0xd6a100c6, 0x402c7279, 0x679f25fe, 0xfb1fa3cc, 0x8ea5e9f8, 0xdb3222f8,
  0x3c7516df, 0xfd616b15, 0x2f501ec8, 0xad0552ab, 0x323db5fa, 0xfd238760,
  0x53317b48, 0x3e00df82, 0x9e5c57bb, 0xca6f8ca0, 0x1a87562e, 0xdf1769db,
  0xd542a8f6, 0x287effc3, 0xac6732c6, 0x8c4f5573, 0x695b27b0, 0xbbca58c8,
  0xe1ffa35d, 0xb8f011a0, 0x10fa3d98, 0xfd2183b8, 0x4afcb56c, 0x2dd1d35b,
  0x9a53e479, 0xb6f84565, 0xd28e49bc, 0x4bfb9790, 0xe1ddf2da, 0xa4cb7e33,
  0x62fb1341, 0xcee4c6e8, 0xef20cada, 0x36774c01, 0xd07e9efe, 0x2bf11fb4,
  0x95dbda4d, 0xae909198, 0xeaad8e71, 0x6b93d5a0, 0xd08ed1d0, 0xafc725e0,
  0x8e3c5b2f, 0x8e7594b7, 0x8ff6e2fb, 0xf2122b64, 0x8888b812, 0x900df01c,
  0x4fad5ea0, 0x688fc31c, 0xd1cff191, 0xb3a8c1ad, 0x2f2f2218, 0xbe0e1777,
  0xea752dfe, 0x8b021fa1, 0xe5a0cc0f, 0xb56f74e8, 0x18acf3d6, 0xce89e299,
  0xb4a84fe0, 0xfd13e0b7, 0x7cc43b81, 0xd2ada8d9, 0x165fa266, 0x80957705,
  0x93cc7314, 0x211a1477, 0xe6ad2065, 0x77b5fa86, 0xc75442f5, 0xfb9d35cf,
  0xebcdaf0c, 0x7b3e89a0, 0xd6411bd3, 0xae1e7e49, 0x00250e2d, 0x2071b35e,
  0x226800bb, 0x57b8e0af, 0x2464369b, 0xf009b91e, 0x5563911d, 0x59dfa6aa,
  0x78c14389, 0xd95a537f, 0x207d5ba2, 0x02e5b9c5, 0x83260376, 0x6295cfa9,
  0x11c81968, 0x4e734a41, 0xb3472dca, 0x7b14a94a, 0x1b510052, 0x9a532915,
  0xd60f573f, 0xbc9bc6e4, 0x2b60a476, 0x81e67400, 0x08ba6fb5, 0x571be91f,
  0xf296ec6b, 0x2a0dd915, 0xb6636521, 0xe7b9f9b6, 0xff34052e, 0xc5855664,
  0x53b02d5d, 0xa99f8fa1, 0x08ba4799, 0x6e85076a
];

/**
 * @static
 * @type {Array}
 */
Blowfish.sBox1 = [
  0x4b7a70e9, 0xb5b32944, 0xdb75092e, 0xc4192623, 0xad6ea6b0, 0x49a7df7d,
  0x9cee60b8, 0x8fedb266, 0xecaa8c71, 0x699a17ff, 0x5664526c, 0xc2b19ee1,
  0x193602a5, 0x75094c29, 0xa0591340, 0xe4183a3e, 0x3f54989a, 0x5b429d65,
  0x6b8fe4d6, 0x99f73fd6, 0xa1d29c07, 0xefe830f5, 0x4d2d38e6, 0xf0255dc1,
  0x4cdd2086, 0x8470eb26, 0x6382e9c6, 0x021ecc5e, 0x09686b3f, 0x3ebaefc9,
  0x3c971814, 0x6b6a70a1, 0x687f3584, 0x52a0e286, 0xb79c5305, 0xaa500737,
  0x3e07841c, 0x7fdeae5c, 0x8e7d44ec, 0x5716f2b8, 0xb03ada37, 0xf0500c0d,
  0xf01c1f04, 0x0200b3ff, 0xae0cf51a, 0x3cb574b2, 0x25837a58, 0xdc0921bd,
  0xd19113f9, 0x7ca92ff6, 0x94324773, 0x22f54701, 0x3ae5e581, 0x37c2dadc,
  0xc8b57634, 0x9af3dda7, 0xa9446146, 0x0fd0030e, 0xecc8c73e, 0xa4751e41,
  0xe238cd99, 0x3bea0e2f, 0x3280bba1, 0x183eb331, 0x4e548b38, 0x4f6db908,
  0x6f420d03, 0xf60a04bf, 0x2cb81290, 0x24977c79, 0x5679b072, 0xbcaf89af,
  0xde9a771f, 0xd9930810, 0xb38bae12, 0xdccf3f2e, 0x5512721f, 0x2e6b7124,
  0x501adde6, 0x9f84cd87, 0x7a584718, 0x7408da17, 0xbc9f9abc, 0xe94b7d8c,
  0xec7aec3a, 0xdb851dfa, 0x63094366, 0xc464c3d2, 0xef1c1847, 0x3215d908,
  0xdd433b37, 0x24c2ba16, 0x12a14d43, 0x2a65c451, 0x50940002, 0x133ae4dd,
  0x71dff89e, 0x10314e55, 0x81ac77d6, 0x5f11199b, 0x043556f1, 0xd7a3c76b,
  0x3c11183b, 0x5924a509, 0xf28fe6ed, 0x97f1fbfa, 0x9ebabf2c, 0x1e153c6e,
  0x86e34570, 0xeae96fb1, 0x860e5e0a, 0x5a3e2ab3, 0x771fe71c, 0x4e3d06fa,
  0x2965dcb9, 0x99e71d0f, 0x803e89d6, 0x5266c825, 0x2e4cc978, 0x9c10b36a,
  0xc6150eba, 0x94e2ea78, 0xa5fc3c53, 0x1e0a2df4, 0xf2f74ea7, 0x361d2b3d,
  0x1939260f, 0x19c27960, 0x5223a708, 0xf71312b6, 0xebadfe6e, 0xeac31f66,
  0xe3bc4595, 0xa67bc883, 0xb17f37d1, 0x018cff28, 0xc332ddef, 0xbe6c5aa5,
  0x65582185, 0x68ab9802, 0xeecea50f, 0xdb2f953b, 0x2aef7dad, 0x5b6e2f84,
  0x1521b628, 0x29076170, 0xecdd4775, 0x619f1510, 0x13cca830, 0xeb61bd96,
  0x0334fe1e, 0xaa0363cf, 0xb5735c90, 0x4c70a239, 0xd59e9e0b, 0xcbaade14,
  0xeecc86bc, 0x60622ca7, 0x9cab5cab, 0xb2f3846e, 0x648b1eaf, 0x19bdf0ca,
  0xa02369b9, 0x655abb50, 0x40685a32, 0x3c2ab4b3, 0x319ee9d5, 0xc021b8f7,
  0x9b540b19, 0x875fa099, 0x95f7997e, 0x623d7da8, 0xf837889a, 0x97e32d77,
  0x11ed935f, 0x16681281, 0x0e358829, 0xc7e61fd6, 0x96dedfa1, 0x7858ba99,
  0x57f584a5, 0x1b227263, 0x9b83c3ff, 0x1ac24696, 0xcdb30aeb, 0x532e3054,
  0x8fd948e4, 0x6dbc3128, 0x58ebf2ef, 0x34c6ffea, 0xfe28ed61, 0xee7c3c73,
  0x5d4a14d9, 0xe864b7e3, 0x42105d14, 0x203e13e0, 0x45eee2b6, 0xa3aaabea,
  0xdb6c4f15, 0xfacb4fd0, 0xc742f442, 0xef6abbb5, 0x654f3b1d, 0x41cd2105,
  0xd81e799e, 0x86854dc7, 0xe44b476a, 0x3d816250, 0xcf62a1f2, 0x5b8d2646,
  0xfc8883a0, 0xc1c7b6a3, 0x7f1524c3, 0x69cb7492, 0x47848a0b, 0x5692b285,
  0x095bbf00, 0xad19489d, 0x1462b174, 0x23820e00, 0x58428d2a, 0x0c55f5ea,
  0x1dadf43e, 0x233f7061, 0x3372f092, 0x8d937e41, 0xd65fecf1, 0x6c223bdb,
  0x7cde3759, 0xcbee7460, 0x4085f2a7, 0xce77326e, 0xa6078084, 0x19f8509e,
  0xe8efd855, 0x61d99735, 0xa969a7aa, 0xc50c06c2, 0x5a04abfc, 0x800bcadc,
  0x9e447a2e, 0xc3453484, 0xfdd56705, 0x0e1e9ec9, 0xdb73dbd3, 0x105588cd,
  0x675fda79, 0xe3674340, 0xc5c43465, 0x713e38d8, 0x3d28f89e, 0xf16dff20,
  0x153e21e7, 0x8fb03d4a, 0xe6e39f2b, 0xdb83adf7
];

/**
 * @static
 * @type {Array}
 */
Blowfish.sBox2 = [
  0xe93d5a68, 0x948140f7, 0xf64c261c, 0x94692934, 0x411520f7, 0x7602d4f7,
  0xbcf46b2e, 0xd4a20068, 0xd4082471, 0x3320f46a, 0x43b7d4b7, 0x500061af,
  0x1e39f62e, 0x97244546, 0x14214f74, 0xbf8b8840, 0x4d95fc1d, 0x96b591af,
  0x70f4ddd3, 0x66a02f45, 0xbfbc09ec, 0x03bd9785, 0x7fac6dd0, 0x31cb8504,
  0x96eb27b3, 0x55fd3941, 0xda2547e6, 0xabca0a9a, 0x28507825, 0x530429f4,
  0x0a2c86da, 0xe9b66dfb, 0x68dc1462, 0xd7486900, 0x680ec0a4, 0x27a18dee,
  0x4f3ffea2, 0xe887ad8c, 0xb58ce006, 0x7af4d6b6, 0xaace1e7c, 0xd3375fec,
  0xce78a399, 0x406b2a42, 0x20fe9e35, 0xd9f385b9, 0xee39d7ab, 0x3b124e8b,
  0x1dc9faf7, 0x4b6d1856, 0x26a36631, 0xeae397b2, 0x3a6efa74, 0xdd5b4332,
  0x6841e7f7, 0xca7820fb, 0xfb0af54e, 0xd8feb397, 0x454056ac, 0xba489527,
  0x55533a3a, 0x20838d87, 0xfe6ba9b7, 0xd096954b, 0x55a867bc, 0xa1159a58,
  0xcca92963, 0x99e1db33, 0xa62a4a56, 0x3f3125f9, 0x5ef47e1c, 0x9029317c,
  0xfdf8e802, 0x04272f70, 0x80bb155c, 0x05282ce3, 0x95c11548, 0xe4c66d22,
  0x48c1133f, 0xc70f86dc, 0x07f9c9ee, 0x41041f0f, 0x404779a4, 0x5d886e17,
  0x325f51eb, 0xd59bc0d1, 0xf2bcc18f, 0x41113564, 0x257b7834, 0x602a9c60,
  0xdff8e8a3, 0x1f636c1b, 0x0e12b4c2, 0x02e1329e, 0xaf664fd1, 0xcad18115,
  0x6b2395e0, 0x333e92e1, 0x3b240b62, 0xeebeb922, 0x85b2a20e, 0xe6ba0d99,
  0xde720c8c, 0x2da2f728, 0xd0127845, 0x95b794fd, 0x647d0862, 0xe7ccf5f0,
  0x5449a36f, 0x877d48fa, 0xc39dfd27, 0xf33e8d1e, 0x0a476341, 0x992eff74,
  0x3a6f6eab, 0xf4f8fd37, 0xa812dc60, 0xa1ebddf8, 0x991be14c, 0xdb6e6b0d,
  0xc67b5510, 0x6d672c37, 0x2765d43b, 0xdcd0e804, 0xf1290dc7, 0xcc00ffa3,
  0xb5390f92, 0x690fed0b, 0x667b9ffb, 0xcedb7d9c, 0xa091cf0b, 0xd9155ea3,
  0xbb132f88, 0x515bad24, 0x7b9479bf, 0x763bd6eb, 0x37392eb3, 0xcc115979,
  0x8026e297, 0xf42e312d, 0x6842ada7, 0xc66a2b3b, 0x12754ccc, 0x782ef11c,
  0x6a124237, 0xb79251e7, 0x06a1bbe6, 0x4bfb6350, 0x1a6b1018, 0x11caedfa,
  0x3d25bdd8, 0xe2e1c3c9, 0x44421659, 0x0a121386, 0xd90cec6e, 0xd5abea2a,
  0x64af674e, 0xda86a85f, 0xbebfe988, 0x64e4c3fe, 0x9dbc8057, 0xf0f7c086,
  0x60787bf8, 0x6003604d, 0xd1fd8346, 0xf6381fb0, 0x7745ae04, 0xd736fccc,
  0x83426b33, 0xf01eab71, 0xb0804187, 0x3c005e5f, 0x77a057be, 0xbde8ae24,
  0x55464299, 0xbf582e61, 0x4e58f48f, 0xf2ddfda2, 0xf474ef38, 0x8789bdc2,
  0x5366f9c3, 0xc8b38e74, 0xb475f255, 0x46fcd9b9, 0x7aeb2661, 0x8b1ddf84,
  0x846a0e79, 0x915f95e2, 0x466e598e, 0x20b45770, 0x8cd55591, 0xc902de4c,
  0xb90bace1, 0xbb8205d0, 0x11a86248, 0x7574a99e, 0xb77f19b6, 0xe0a9dc09,
  0x662d09a1, 0xc4324633, 0xe85a1f02, 0x09f0be8c, 0x4a99a025, 0x1d6efe10,
  0x1ab93d1d, 0x0ba5a4df, 0xa186f20f, 0x2868f169, 0xdcb7da83, 0x573906fe,
  0xa1e2ce9b, 0x4fcd7f52, 0x50115e01, 0xa70683fa, 0xa002b5c4, 0x0de6d027,
  0x9af88c27, 0x773f8641, 0xc3604c06, 0x61a806b5, 0xf0177a28, 0xc0f586e0,
  0x006058aa, 0x30dc7d62, 0x11e69ed7, 0x2338ea63, 0x53c2dd94, 0xc2c21634,
  0xbbcbee56, 0x90bcb6de, 0xebfc7da1, 0xce591d76, 0x6f05e409, 0x4b7c0188,
  0x39720a3d, 0x7c927c24, 0x86e3725f, 0x724d9db9, 0x1ac15bb4, 0xd39eb8fc,
  0xed545578, 0x08fca5b5, 0xd83d7cd3, 0x4dad0fc4, 0x1e50ef5e, 0xb161e6f8,
  0xa28514d9, 0x6c51133c, 0x6fd5c7e7, 0x56e14ec4, 0x362abfce, 0xddc6c837,
  0xd79a3234, 0x92638212, 0x670efa8e, 0x406000e0
];

/**
 * @static
 * @type {Array}
 */
Blowfish.sBox3 = [
  0x3a39ce37, 0xd3faf5cf, 0xabc27737, 0x5ac52d1b, 0x5cb0679e, 0x4fa33742,
  0xd3822740, 0x99bc9bbe, 0xd5118e9d, 0xbf0f7315, 0xd62d1c7e, 0xc700c47b,
  0xb78c1b6b, 0x21a19045, 0xb26eb1be, 0x6a366eb4, 0x5748ab2f, 0xbc946e79,
  0xc6a376d2, 0x6549c2c8, 0x530ff8ee, 0x468dde7d, 0xd5730a1d, 0x4cd04dc6,
  0x2939bbdb, 0xa9ba4650, 0xac9526e8, 0xbe5ee304, 0xa1fad5f0, 0x6a2d519a,
  0x63ef8ce2, 0x9a86ee22, 0xc089c2b8, 0x43242ef6, 0xa51e03aa, 0x9cf2d0a4,
  0x83c061ba, 0x9be96a4d, 0x8fe51550, 0xba645bd6, 0x2826a2f9, 0xa73a3ae1,
  0x4ba99586, 0xef5562e9, 0xc72fefd3, 0xf752f7da, 0x3f046f69, 0x77fa0a59,
  0x80e4a915, 0x87b08601, 0x9b09e6ad, 0x3b3ee593, 0xe990fd5a, 0x9e34d797,
  0x2cf0b7d9, 0x022b8b51, 0x96d5ac3a, 0x017da67d, 0xd1cf3ed6, 0x7c7d2d28,
  0x1f9f25cf, 0xadf2b89b, 0x5ad6b472, 0x5a88f54c, 0xe029ac71, 0xe019a5e6,
  0x47b0acfd, 0xed93fa9b, 0xe8d3c48d, 0x283b57cc, 0xf8d56629, 0x79132e28,
  0x785f0191, 0xed756055, 0xf7960e44, 0xe3d35e8c, 0x15056dd4, 0x88f46dba,
  0x03a16125, 0x0564f0bd, 0xc3eb9e15, 0x3c9057a2, 0x97271aec, 0xa93a072a,
  0x1b3f6d9b, 0x1e6321f5, 0xf59c66fb, 0x26dcf319, 0x7533d928, 0xb155fdf5,
  0x03563482, 0x8aba3cbb, 0x28517711, 0xc20ad9f8, 0xabcc5167, 0xccad925f,
  0x4de81751, 0x3830dc8e, 0x379d5862, 0x9320f991, 0xea7a90c2, 0xfb3e7bce,
  0x5121ce64, 0x774fbe32, 0xa8b6e37e, 0xc3293d46, 0x48de5369, 0x6413e680,
  0xa2ae0810, 0xdd6db224, 0x69852dfd, 0x09072166, 0xb39a460a, 0x6445c0dd,
  0x586cdecf, 0x1c20c8ae, 0x5bbef7dd, 0x1b588d40, 0xccd2017f, 0x6bb4e3bb,
  0xdda26a7e, 0x3a59ff45, 0x3e350a44, 0xbcb4cdd5, 0x72eacea8, 0xfa6484bb,
  0x8d6612ae, 0xbf3c6f47, 0xd29be463, 0x542f5d9e, 0xaec2771b, 0xf64e6370,
  0x740e0d8d, 0xe75b1357, 0xf8721671, 0xaf537d5d, 0x4040cb08, 0x4eb4e2cc,
  0x34d2466a, 0x0115af84, 0xe1b00428, 0x95983a1d, 0x06b89fb4, 0xce6ea048,
  0x6f3f3b82, 0x3520ab82, 0x011a1d4b, 0x277227f8, 0x611560b1, 0xe7933fdc,
  0xbb3a792b, 0x344525bd, 0xa08839e1, 0x51ce794b, 0x2f32c9b7, 0xa01fbac9,
  0xe01cc87e, 0xbcc7d1f6, 0xcf0111c3, 0xa1e8aac7, 0x1a908749, 0xd44fbd9a,
  0xd0dadecb, 0xd50ada38, 0x0339c32a, 0xc6913667, 0x8df9317c, 0xe0b12b4f,
  0xf79e59b7, 0x43f5bb3a, 0xf2d519ff, 0x27d9459c, 0xbf97222c, 0x15e6fc2a,
  0x0f91fc71, 0x9b941525, 0xfae59361, 0xceb69ceb, 0xc2a86459, 0x12baa8d1,
  0xb6c1075e, 0xe3056a0c, 0x10d25065, 0xcb03a442, 0xe0ec6e0e, 0x1698db3b,
  0x4c98a0be, 0x3278e964, 0x9f1f9532, 0xe0d392df, 0xd3a0342b, 0x8971f21e,
  0x1b0a7441, 0x4ba3348c, 0xc5be7120, 0xc37632d8, 0xdf359f8d, 0x9b992f2e,
  0xe60b6f47, 0x0fe3f11d, 0xe54cda54, 0x1edad891, 0xce6279cf, 0xcd3e7e6f,
  0x1618b166, 0xfd2c1d05, 0x848fd2c5, 0xf6fb2299, 0xf523f357, 0xa6327623,
  0x93a83531, 0x56cccd02, 0xacf08162, 0x5a75ebb5, 0x6e163697, 0x88d273cc,
  0xde966292, 0x81b949d0, 0x4c50901b, 0x71c65614, 0xe6c6c7bd, 0x327a140a,
  0x45e1d006, 0xc3f27b9a, 0xc9aa53fd, 0x62a80f00, 0xbb25bfe2, 0x35bdd2f6,
  0x71126905, 0xb2040222, 0xb6cbcf7c, 0xcd769c2b, 0x53113ec0, 0x1640e3d3,
  0x38abbd60, 0x2547adf0, 0xba38209c, 0xf746ce76, 0x77afa1c5, 0x20756060,
  0x85cbfe4e, 0x8ae88dd8, 0x7aaaf9b0, 0x4cf9aa7e, 0x1948c25c, 0x02fb8a8c,
  0x01c36ae4, 0xd6ebe1f9, 0x90d4f869, 0xa65cdea0, 0x3f09252d, 0xc208e69f,
  0xb74e6132, 0xce77e25b, 0x578fdfe3, 0x3ac372e6
];


</script>
</body>
</html>
